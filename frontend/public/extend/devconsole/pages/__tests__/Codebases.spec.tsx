import * as React from 'react';
import { shallow, ShallowWrapper } from 'enzyme'
import CodebasePage from '../../components/codebases/CodebasePage'
import CodebaseList from '../../components/codebases/CodebaseList'
import CodebaseHeader from '../../components/codebases/CodebaseHeader'
import CodebaseRow from '../../components/codebases/CodebaseRow'
import { ListPage, List } from '../../../../components/factory';

const mockOpenshiftProps = {"kinds":["Component"],"label":"Components","reduxIDs":["components---{\"ns\":\"openshift\"}"],"k8sModels":{"Component":{"apiGroup":"devopsconsole.openshift.io","apiVersion":"v1alpha1","label":"Component","path":"components","plural":"components","abbr":"CM","namespaced":true,"kind":"Component","id":"component","labelPlural":"Components"}},"loaded":true,"inFlight":false,"Component":{"data":[{"apiVersion":"devopsconsole.openshift.io/v1alpha1","kind":"Component","metadata":{"creationTimestamp":"2019-03-10T09:44:40Z","generation":1,"name":"christian","namespace":"openshift","resourceVersion":"1052511","selfLink":"/apis/devopsconsole.openshift.io/v1alpha1/namespaces/openshift/components/christian","uid":"20394726-4319-11e9-abb0-52540042b047"},"spec":{"app":"openshiftio","buildtype":"nodejs","codebase":"https://github.com/sbose78/nodejs-rest-http-crud","listenport":8080}},{"apiVersion":"devopsconsole.openshift.io/v1alpha1","kind":"Component","metadata":{"creationTimestamp":"2019-03-10T09:47:23Z","generation":1,"name":"nimisha","namespace":"openshift","resourceVersion":"1053167","selfLink":"/apis/devopsconsole.openshift.io/v1alpha1/namespaces/openshift/components/nimisha","uid":"81197394-4319-11e9-abb0-52540042b047"},"spec":{"app":"openshiftio","buildtype":"react","codebase":"https://github.com/sbose78/nodejs-rest-http-crud","listenport":9000}},{"apiVersion":"devopsconsole.openshift.io/v1alpha1","kind":"Component","metadata":{"creationTimestamp":"2019-03-10T09:49:38Z","generation":1,"name":"vikram","namespace":"openshift","resourceVersion":"1053716","selfLink":"/apis/devopsconsole.openshift.io/v1alpha1/namespaces/openshift/components/vikram","uid":"d19b4b47-4319-11e9-abb0-52540042b047"},"spec":{"app":"kube-dns","buildtype":"nodejs","codebase":"https://github.com/sbose78/nodejs-rest-http-crud","listenport":8080}}],"filters":{},"loadError":"","loaded":true,"selected":null},"filters":{},"resources":{"Component":{"data":[{"apiVersion":"devopsconsole.openshift.io/v1alpha1","kind":"Component","metadata":{"creationTimestamp":"2019-03-10T09:44:40Z","generation":1,"name":"christian","namespace":"openshift","resourceVersion":"1052511","selfLink":"/apis/devopsconsole.openshift.io/v1alpha1/namespaces/openshift/components/christian","uid":"20394726-4319-11e9-abb0-52540042b047"},"spec":{"app":"openshiftio","buildtype":"nodejs","codebase":"https://github.com/sbose78/nodejs-rest-http-crud","listenport":8080}},{"apiVersion":"devopsconsole.openshift.io/v1alpha1","kind":"Component","metadata":{"creationTimestamp":"2019-03-10T09:47:23Z","generation":1,"name":"nimisha","namespace":"openshift","resourceVersion":"1053167","selfLink":"/apis/devopsconsole.openshift.io/v1alpha1/namespaces/openshift/components/nimisha","uid":"81197394-4319-11e9-abb0-52540042b047"},"spec":{"app":"openshiftio","buildtype":"react","codebase":"https://github.com/sbose78/nodejs-rest-http-crud","listenport":9000}},{"apiVersion":"devopsconsole.openshift.io/v1alpha1","kind":"Component","metadata":{"creationTimestamp":"2019-03-10T09:49:38Z","generation":1,"name":"vikram","namespace":"openshift","resourceVersion":"1053716","selfLink":"/apis/devopsconsole.openshift.io/v1alpha1/namespaces/openshift/components/vikram","uid":"d19b4b47-4319-11e9-abb0-52540042b047"},"spec":{"app":"kube-dns","buildtype":"nodejs","codebase":"https://github.com/sbose78/nodejs-rest-http-crud","listenport":8080}}],"filters":{},"loadError":"","loaded":true,"selected":null}},"data":[{"apiVersion":"devopsconsole.openshift.io/v1alpha1","kind":"Component","metadata":{"creationTimestamp":"2019-03-10T09:44:40Z","generation":1,"name":"christian","namespace":"openshift","resourceVersion":"1052511","selfLink":"/apis/devopsconsole.openshift.io/v1alpha1/namespaces/openshift/components/christian","uid":"20394726-4319-11e9-abb0-52540042b047"},"spec":{"app":"openshiftio","buildtype":"nodejs","codebase":"https://github.com/sbose78/nodejs-rest-http-crud","listenport":8080}},{"apiVersion":"devopsconsole.openshift.io/v1alpha1","kind":"Component","metadata":{"creationTimestamp":"2019-03-10T09:47:23Z","generation":1,"name":"nimisha","namespace":"openshift","resourceVersion":"1053167","selfLink":"/apis/devopsconsole.openshift.io/v1alpha1/namespaces/openshift/components/nimisha","uid":"81197394-4319-11e9-abb0-52540042b047"},"spec":{"app":"openshiftio","buildtype":"react","codebase":"https://github.com/sbose78/nodejs-rest-http-crud","listenport":9000}},{"apiVersion":"devopsconsole.openshift.io/v1alpha1","kind":"Component","metadata":{"creationTimestamp":"2019-03-10T09:49:38Z","generation":1,"name":"vikram","namespace":"openshift","resourceVersion":"1053716","selfLink":"/apis/devopsconsole.openshift.io/v1alpha1/namespaces/openshift/components/vikram","uid":"d19b4b47-4319-11e9-abb0-52540042b047"},"spec":{"app":"kube-dns","buildtype":"nodejs","codebase":"https://github.com/sbose78/nodejs-rest-http-crud","listenport":8080}}]};
const mockMyprojectProps = {"kinds":["Component"],"label":"Components","reduxIDs":["components---{\"ns\":\"myproject\"}"],"k8sModels":{"Component":{"apiGroup":"devopsconsole.openshift.io","apiVersion":"v1alpha1","label":"Component","path":"components","plural":"components","abbr":"CM","namespaced":true,"kind":"Component","id":"component","labelPlural":"Components"}},"loaded":true,"inFlight":false,"Component":{"data":[{"apiVersion":"devopsconsole.openshift.io/v1alpha1","kind":"Component","metadata":{"creationTimestamp":"2019-03-10T09:47:43Z","generation":1,"name":"debsmita","namespace":"myproject","resourceVersion":"1053249","selfLink":"/apis/devopsconsole.openshift.io/v1alpha1/namespaces/myproject/components/debsmita","uid":"8d0b12ac-4319-11e9-abb0-52540042b047"},"spec":{"app":"myproject","buildtype":"react","codebase":"https://github.com/sbose78/nodejs-rest-http-crud","listenport":9000}},{"apiVersion":"devopsconsole.openshift.io/v1alpha1","kind":"Component","metadata":{"creationTimestamp":"2019-03-10T09:48:06Z","generation":1,"name":"dimo","namespace":"myproject","resourceVersion":"1053345","selfLink":"/apis/devopsconsole.openshift.io/v1alpha1/namespaces/myproject/components/dimo","uid":"9ad19bb1-4319-11e9-abb0-52540042b047"},"spec":{"app":"kube-dns","buildtype":"nodejs","codebase":"https://github.com/sbose78/nodejs-rest-http-crud","listenport":8080}},{"apiVersion":"devopsconsole.openshift.io/v1alpha1","kind":"Component","metadata":{"creationTimestamp":"2019-03-10T09:47:55Z","generation":1,"name":"karthik","namespace":"myproject","resourceVersion":"1053300","selfLink":"/apis/devopsconsole.openshift.io/v1alpha1/namespaces/myproject/components/karthik","uid":"94876232-4319-11e9-abb0-52540042b047"},"spec":{"app":"myproject","buildtype":"react","codebase":"https://github.com/sbose78/nodejs-rest-http-crud","listenport":9000}}],"filters":{},"loadError":"","loaded":true,"selected":null},"filters":{},"resources":{"Component":{"data":[{"apiVersion":"devopsconsole.openshift.io/v1alpha1","kind":"Component","metadata":{"creationTimestamp":"2019-03-10T09:47:43Z","generation":1,"name":"debsmita","namespace":"myproject","resourceVersion":"1053249","selfLink":"/apis/devopsconsole.openshift.io/v1alpha1/namespaces/myproject/components/debsmita","uid":"8d0b12ac-4319-11e9-abb0-52540042b047"},"spec":{"app":"myproject","buildtype":"react","codebase":"https://github.com/sbose78/nodejs-rest-http-crud","listenport":9000}},{"apiVersion":"devopsconsole.openshift.io/v1alpha1","kind":"Component","metadata":{"creationTimestamp":"2019-03-10T09:48:06Z","generation":1,"name":"dimo","namespace":"myproject","resourceVersion":"1053345","selfLink":"/apis/devopsconsole.openshift.io/v1alpha1/namespaces/myproject/components/dimo","uid":"9ad19bb1-4319-11e9-abb0-52540042b047"},"spec":{"app":"kube-dns","buildtype":"nodejs","codebase":"https://github.com/sbose78/nodejs-rest-http-crud","listenport":8080}},{"apiVersion":"devopsconsole.openshift.io/v1alpha1","kind":"Component","metadata":{"creationTimestamp":"2019-03-10T09:47:55Z","generation":1,"name":"karthik","namespace":"myproject","resourceVersion":"1053300","selfLink":"/apis/devopsconsole.openshift.io/v1alpha1/namespaces/myproject/components/karthik","uid":"94876232-4319-11e9-abb0-52540042b047"},"spec":{"app":"myproject","buildtype":"react","codebase":"https://github.com/sbose78/nodejs-rest-http-crud","listenport":9000}}],"filters":{},"loadError":"","loaded":true,"selected":null}},"data":[{"apiVersion":"devopsconsole.openshift.io/v1alpha1","kind":"Component","metadata":{"creationTimestamp":"2019-03-10T09:47:43Z","generation":1,"name":"debsmita","namespace":"myproject","resourceVersion":"1053249","selfLink":"/apis/devopsconsole.openshift.io/v1alpha1/namespaces/myproject/components/debsmita","uid":"8d0b12ac-4319-11e9-abb0-52540042b047"},"spec":{"app":"myproject","buildtype":"react","codebase":"https://github.com/sbose78/nodejs-rest-http-crud","listenport":9000}},{"apiVersion":"devopsconsole.openshift.io/v1alpha1","kind":"Component","metadata":{"creationTimestamp":"2019-03-10T09:48:06Z","generation":1,"name":"dimo","namespace":"myproject","resourceVersion":"1053345","selfLink":"/apis/devopsconsole.openshift.io/v1alpha1/namespaces/myproject/components/dimo","uid":"9ad19bb1-4319-11e9-abb0-52540042b047"},"spec":{"app":"kube-dns","buildtype":"nodejs","codebase":"https://github.com/sbose78/nodejs-rest-http-crud","listenport":8080}},{"apiVersion":"devopsconsole.openshift.io/v1alpha1","kind":"Component","metadata":{"creationTimestamp":"2019-03-10T09:47:55Z","generation":1,"name":"karthik","namespace":"myproject","resourceVersion":"1053300","selfLink":"/apis/devopsconsole.openshift.io/v1alpha1/namespaces/myproject/components/karthik","uid":"94876232-4319-11e9-abb0-52540042b047"},"spec":{"app":"myproject","buildtype":"react","codebase":"https://github.com/sbose78/nodejs-rest-http-crud","listenport":9000}}]};
const mockKubeDnsProps   = {"kinds":["Component"],"label":"Components","reduxIDs":["components---{\"ns\":\"kube-dns\"}"],"k8sModels":{"Component":{"apiGroup":"devopsconsole.openshift.io","apiVersion":"v1alpha1","label":"Component","path":"components","plural":"components","abbr":"CM","namespaced":true,"kind":"Component","id":"component","labelPlural":"Components"}},"loaded":true,"inFlight":false,"Component":{"data":[{"apiVersion":"devopsconsole.openshift.io/v1alpha1","kind":"Component","metadata":{"creationTimestamp":"2019-03-10T09:48:26Z","generation":1,"name":"divyanshi","namespace":"kube-dns","resourceVersion":"1053427","selfLink":"/apis/devopsconsole.openshift.io/v1alpha1/namespaces/kube-dns/components/divyanshi","uid":"a7154603-4319-11e9-abb0-52540042b047"},"spec":{"app":"openshiftio","buildtype":"Angular","codebase":"https://github.com/sbose78/nodejs-rest-http-crud","listenport":4200}},{"apiVersion":"devopsconsole.openshift.io/v1alpha1","kind":"Component","metadata":{"creationTimestamp":"2019-03-10T09:49:58Z","generation":1,"name":"joshua","namespace":"kube-dns","resourceVersion":"1053800","selfLink":"/apis/devopsconsole.openshift.io/v1alpha1/namespaces/kube-dns/components/joshua","uid":"ddcf1e74-4319-11e9-abb0-52540042b047"},"spec":{"app":"kube-dns","buildtype":"angular","codebase":"https://github.com/sbose78/nodejs-rest-http-crud","listenport":4200}},{"apiVersion":"devopsconsole.openshift.io/v1alpha1","kind":"Component","metadata":{"creationTimestamp":"2019-03-10T09:49:14Z","generation":1,"name":"rohit","namespace":"kube-dns","resourceVersion":"1053621","selfLink":"/apis/devopsconsole.openshift.io/v1alpha1/namespaces/kube-dns/components/rohit","uid":"c37d3c88-4319-11e9-abb0-52540042b047"},"spec":{"app":"openshiftio","buildtype":"nodejs","codebase":"https://github.com/sbose78/nodejs-rest-http-crud","listenport":8080}},{"apiVersion":"devopsconsole.openshift.io/v1alpha1","kind":"Component","metadata":{"creationTimestamp":"2019-03-10T09:48:42Z","generation":1,"name":"sahil","namespace":"kube-dns","resourceVersion":"1053494","selfLink":"/apis/devopsconsole.openshift.io/v1alpha1/namespaces/kube-dns/components/sahil","uid":"b0a3ddb1-4319-11e9-abb0-52540042b047"},"spec":{"app":"kube-dns","buildtype":"react","codebase":"https://github.com/sbose78/nodejs-rest-http-crud","listenport":9000}}],"filters":{},"loadError":"","loaded":true,"selected":null},"filters":{},"resources":{"Component":{"data":[{"apiVersion":"devopsconsole.openshift.io/v1alpha1","kind":"Component","metadata":{"creationTimestamp":"2019-03-10T09:48:26Z","generation":1,"name":"divyanshi","namespace":"kube-dns","resourceVersion":"1053427","selfLink":"/apis/devopsconsole.openshift.io/v1alpha1/namespaces/kube-dns/components/divyanshi","uid":"a7154603-4319-11e9-abb0-52540042b047"},"spec":{"app":"openshiftio","buildtype":"Angular","codebase":"https://github.com/sbose78/nodejs-rest-http-crud","listenport":4200}},{"apiVersion":"devopsconsole.openshift.io/v1alpha1","kind":"Component","metadata":{"creationTimestamp":"2019-03-10T09:49:58Z","generation":1,"name":"joshua","namespace":"kube-dns","resourceVersion":"1053800","selfLink":"/apis/devopsconsole.openshift.io/v1alpha1/namespaces/kube-dns/components/joshua","uid":"ddcf1e74-4319-11e9-abb0-52540042b047"},"spec":{"app":"kube-dns","buildtype":"angular","codebase":"https://github.com/sbose78/nodejs-rest-http-crud","listenport":4200}},{"apiVersion":"devopsconsole.openshift.io/v1alpha1","kind":"Component","metadata":{"creationTimestamp":"2019-03-10T09:49:14Z","generation":1,"name":"rohit","namespace":"kube-dns","resourceVersion":"1053621","selfLink":"/apis/devopsconsole.openshift.io/v1alpha1/namespaces/kube-dns/components/rohit","uid":"c37d3c88-4319-11e9-abb0-52540042b047"},"spec":{"app":"openshiftio","buildtype":"nodejs","codebase":"https://github.com/sbose78/nodejs-rest-http-crud","listenport":8080}},{"apiVersion":"devopsconsole.openshift.io/v1alpha1","kind":"Component","metadata":{"creationTimestamp":"2019-03-10T09:48:42Z","generation":1,"name":"sahil","namespace":"kube-dns","resourceVersion":"1053494","selfLink":"/apis/devopsconsole.openshift.io/v1alpha1/namespaces/kube-dns/components/sahil","uid":"b0a3ddb1-4319-11e9-abb0-52540042b047"},"spec":{"app":"kube-dns","buildtype":"react","codebase":"https://github.com/sbose78/nodejs-rest-http-crud","listenport":9000}}],"filters":{},"loadError":"","loaded":true,"selected":null}},"data":[{"apiVersion":"devopsconsole.openshift.io/v1alpha1","kind":"Component","metadata":{"creationTimestamp":"2019-03-10T09:48:26Z","generation":1,"name":"divyanshi","namespace":"kube-dns","resourceVersion":"1053427","selfLink":"/apis/devopsconsole.openshift.io/v1alpha1/namespaces/kube-dns/components/divyanshi","uid":"a7154603-4319-11e9-abb0-52540042b047"},"spec":{"app":"openshiftio","buildtype":"Angular","codebase":"https://github.com/sbose78/nodejs-rest-http-crud","listenport":4200}},{"apiVersion":"devopsconsole.openshift.io/v1alpha1","kind":"Component","metadata":{"creationTimestamp":"2019-03-10T09:49:58Z","generation":1,"name":"joshua","namespace":"kube-dns","resourceVersion":"1053800","selfLink":"/apis/devopsconsole.openshift.io/v1alpha1/namespaces/kube-dns/components/joshua","uid":"ddcf1e74-4319-11e9-abb0-52540042b047"},"spec":{"app":"kube-dns","buildtype":"angular","codebase":"https://github.com/sbose78/nodejs-rest-http-crud","listenport":4200}},{"apiVersion":"devopsconsole.openshift.io/v1alpha1","kind":"Component","metadata":{"creationTimestamp":"2019-03-10T09:49:14Z","generation":1,"name":"rohit","namespace":"kube-dns","resourceVersion":"1053621","selfLink":"/apis/devopsconsole.openshift.io/v1alpha1/namespaces/kube-dns/components/rohit","uid":"c37d3c88-4319-11e9-abb0-52540042b047"},"spec":{"app":"openshiftio","buildtype":"nodejs","codebase":"https://github.com/sbose78/nodejs-rest-http-crud","listenport":8080}},{"apiVersion":"devopsconsole.openshift.io/v1alpha1","kind":"Component","metadata":{"creationTimestamp":"2019-03-10T09:48:42Z","generation":1,"name":"sahil","namespace":"kube-dns","resourceVersion":"1053494","selfLink":"/apis/devopsconsole.openshift.io/v1alpha1/namespaces/kube-dns/components/sahil","uid":"b0a3ddb1-4319-11e9-abb0-52540042b047"},"spec":{"app":"kube-dns","buildtype":"react","codebase":"https://github.com/sbose78/nodejs-rest-http-crud","listenport":9000}}]}; 


describe('Check namespace based Codebase lists are generated', () => {
  let codebaseWrapper: ShallowWrapper, codebaseListWrapper:ShallowWrapper;
  let namespaces = [{name: "openshift", props: mockOpenshiftProps}, {name:"myproject", props: mockMyprojectProps}, {name: "kube-dns", props : mockKubeDnsProps}]; 
  // Resource kind needs to be updated once final API
  //let ResourceKind = "Component"
  it('Check that CodebasePage renders a List View', () => {
    codebaseWrapper = shallow(
      <CodebasePage/>
    );
    let List = codebaseWrapper.find(ListPage)
    if(List)        
     console.log("List View is rendered successfully");
    expect(List.exists()).toBe(true);
  });
  namespaces.map((namespace) => { 
    it('Check that CodebaseList renders a list View for ' + namespace.name + " namespace", () => {
      codebaseListWrapper = shallow(
        //passing mock list data as props  
        <CodebaseList {...namespace.props} Header={CodebaseHeader} Row={CodebaseRow}/>
      );
      let resourceList = codebaseListWrapper.find(List);
      if(resourceList.length > 0)        
        console.log("Renders rows successfully for " + namespace.name + " namespace");
      expect(resourceList.length).toBeGreaterThan(0);
    });
  });
});